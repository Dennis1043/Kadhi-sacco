<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fines - KADHI SACCO</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Roboto',sans-serif; background:#f5f5f5; }
    header { background:#2c3e50; color:white; padding:1rem; text-align:center; }
    .container { padding:1rem; }
    .fine-card {
      background:white; padding:1rem; margin-bottom:1rem;
      border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1);
    }
    .fine-card h4 { margin:0 0 0.5rem 0; color:#c0392b; }
    .fine-card p { margin:0.2rem 0; font-size:0.95rem; color:#333; }
    .bottom-nav {
      position:fixed; bottom:0; width:100%; background:white;
      display:flex; justify-content:space-around; border-top:1px solid #ddd; padding:0.5rem 0;
    }
    .bottom-nav a { text-decoration:none; color:#555; text-align:center; font-size:0.8rem; }
    .bottom-nav i { display:block; font-size:1.5rem; margin-bottom:2px; }
    #notification {
      position:fixed; top:1rem; left:50%; transform:translateX(-50%);
      background:#27ae60; color:white; padding:0.5rem 1rem; border-radius:5px;
      display:none;
    }
  </style>
</head>
<body>
  <header><h2>Fines</h2></header>

  <div class="container" id="fineList">
    <p>Loading fines...</p>
  </div>

  <div id="notification">New fine added!</div>

  <nav class="bottom-nav">
    <a href="dashboard.html"><i class="material-icons">home</i>Dashboard</a>
    <a href="contribution.html"><i class="material-icons">savings</i>Contribute</a>
    <a href="loan-request.html"><i class="material-icons">request_quote</i>Loans</a>
    <a href="fines.html" class="active"><i class="material-icons">gavel</i>Fines</a>
    <a href="view-balance.html"><i class="material-icons">account_balance_wallet</i>Balance</a>
  </nav>

  <script>
    const fineList = document.getElementById("fineList");
    const notification = document.getElementById("notification");

    function showNotification(msg) {
      notification.textContent = msg;
      notification.style.display = "block";
      setTimeout(() => notification.style.display = "none", 3000);
    }

    // âœ… check login
    const userId = localStorage.getItem("userId");
    if (!userId) {
      window.location.href = "index.html"; // force login
    }

    async function loadFines() {
      try {
        const res = await fetch(`http://127.0.0.1:5000/user-fines/${userId}`);
        const data = await res.json();

        fineList.innerHTML = "";
        if (!data.length) {
          fineList.innerHTML = "<p>No fines yet ðŸŽ‰</p>";
          return;
        }

        data.forEach(fine => {
          const div = document.createElement("div");
          div.className = "fine-card";
          div.innerHTML = `
            <h4>Fine: KES ${fine.amount}</h4>
            <p>Reason: ${fine.reason}</p>
            <p>Deadline: ${fine.deadline || "-"}</p>
            <p>Date Issued: ${fine.timestamp}</p>
          `;
          fineList.appendChild(div);
        });

      } catch (err) {
        fineList.innerHTML = `<p style="color:red;">Error loading fines: ${err.message}</p>`;
      }
    }

    loadFines();
  </script>
</body>
</html>     